<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>登录</title>
</head>
<body>
    <div>
        <h3>登录</h3>
        <form method="post">
            <label for="username">学号:</label><br>
            <input type="text" id="username" name="username" required><br>
            <label for="password">密码:</label><br>
            <input type="password" id="password" name="password" required><br>
            <input type="submit" value="登录">
            <% if (request.getMethod().equals("POST")) {
                    String username = request.getParameter("username");
                    String password = request.getParameter("password");

                    StudentsDAOImpl studentsDAO = new StudentsDAOImpl();
                    boolean loginSuccess = false;
                    try {
                        loginSuccess = studentsDAO.verifyStudentLogin(username, password);
                    } catch (Exception e) {
                        throw new RuntimeException(e);
                    }

                    if (loginSuccess) {
                        request.getSession().setAttribute("username", username);
                        String redirectUrl = "welcome.jsp";
                        response.sendRedirect(redirectUrl);
                    } else {
                        // 登录失败，显示错误消息
                        out.println("<p>用户名或密码错误</p>");
                    }
                }
            %>
        </form>
    </div>
</body>
</html>
